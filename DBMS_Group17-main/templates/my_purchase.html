{% extends 'base.html' %}
{% block body %}
<h3>My Purchase Records</h3>
<form method="post" class="d-flex mb-4">
    <input name="q" class="form-control w-25" placeholder="Search by course/product" value="{{ q }}">
    <button class="btn btn-primary ms-2" type="submit">Search</button>
</form>
<table class="table table-striped">
 <thead>
 <tr>
   <th>Type</th>
   <th>Name</th>
   <th>Date</th>
   <th>Quantity</th>
   <th>Total Cost</th>
   <th>Action</th>
 </tr>
 </thead>
 <tbody>
 {% for r in records %}
   <tr>
     <td>{{ 'Course' if r.type=='course' else 'Product' }}</td>
     <td>{{ r.item_name }}</td>
     <td>{{ r.purchase_time.strftime('%Y-%m-%d %H:%M') }}</td>
     <td>{{ r.number }}</td>
     <td>ï¿¥{{ r.total_fee }}</td>
     <td>
      {% if r.type=='course' %}
        <a href="{{ url_for('quit_course', course_id=r.ref_id) }}" class="btn btn-warning btn-sm">Drop Course</a>
      {% else %}
        <span class="text-muted">(Non-refundable)</span>
      {% endif %}
     </td>
   </tr>
 {% endfor %}
 </tbody>
</table>
{% endblock %}